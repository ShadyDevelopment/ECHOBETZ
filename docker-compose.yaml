services:
  # Database and Cache
  redis:
    image: redis:6-alpine
    ports:
      - "6379:6379"

  # Core ECHOBETZ Services (Go/gRPC)
  rng-service:
    build:
      context: .
      # PATH: services/rng-service/Dockerfile
      dockerfile: services/rng-service/Dockerfile
    ports:
      - "50051:50051"
    # Placeholder: Assuming you have a Dockerfile for the Go service

  game-engine-service:
    build:
      context: .
      # PATH: services/game-engine-service/Dockerfile
      dockerfile: services/game-engine-service/Dockerfile
    ports:
      - "50052:50052"
    depends_on:
      - rng-service
    volumes:
      - ./config:/app/config

  # External-facing services (Node.js/TypeScript)
  integration-gateway:
    build:
      context: .
      # PATH: services/integration-gateway/Dockerfile
      dockerfile: services/integration-gateway/Dockerfile
    ports:
      - "8080:8080"
    environment:
      - RNG_SERVER_ADDR=rng-service:50051
      - GES_SERVER_ADDR=game-engine-service:50052
    depends_on:
      - rng-service
      - game-engine-service
      - test-casino
      
  test-casino:
    build:
      context: .
      # PATH: test-casino/Dockerfile
      dockerfile: test-casino/Dockerfile
    ports:
      - "3000:3000"
    # Placeholder: Assuming you have a Dockerfile for the Casino service